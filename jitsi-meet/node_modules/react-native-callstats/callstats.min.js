/*! callstats.js  version = 3.27.0 2017-12-14 */
"use strict";!function(){function a(){function a(){var a=(Math.random()+1).toString(36);return a.substring(2,a.length)}function b(){return window.performance.now?window.performance.now()+window.performance.timing.navigationStart:Date.now()}function c(){var a=b();return a+bb.currentOffset}function d(a){if(!$a||!$a.rtc_rtp_parameters||!$a.rtc_rtp_parameters.encodings)return void a.streams.forEach(function(a){var b=a.data;"video"===b.mediaType&&a.streamType===ub.outbound&&(b.csioSCSValidationSampleCount=null,b.csioAvgMaxBitrateDiff=null,b.csioAvgDeltaThroughput=null,b.csioMaxBitrateAboveRatio=null,b.csioCCDrivenRatio=null)});var b=function(a){return Sb[a]?Sb[a]:(Sb[a]={total:0,above:0,ccDriven:0,sumMaxBitrateDiff:0,sumThroughputDiff:0,prevCsioAvgBRKbps:0},Sb[a])},c=function(a,c,d,e,f){var g=b(a.ssrc);a.csioSCSValidationSampleCount=++g.total,g.sumMaxBitrateDiff+=c,a.csioAvgMaxBitrateDiff=g.sumMaxBitrateDiff/g.total,g.sumThroughputDiff+=d,a.csioAvgDeltaThroughput=g.sumThroughputDiff/g.total,e&&(g.above+=1),a.csioMaxBitrateAboveRatio=g.above/g.total,f&&(g.ccDriven+=1),a.csioCCDrivenRatio=g.ccDriven/g.total},d=0;$a.rtc_rtp_parameters.encodings.forEach(function(a){a&&(d=Math.max(d,a.maxBitrate))});var e=0;if(_a){_a.encodings.forEach(function(a){e=Math.max(e,a.maxBitrate)});var f=0,g=0,h=null,i=null;a.streams.forEach(function(a){var j=a.data,k=b(j.ssrc);"video"===j.mediaType&&a.streamType===ub.outbound&&(0<e&&.9*e<1e3*j.csioAvgBRKbps?(f=d-e,i=!1):(f=d-1e3*j.csioAvgBRKbps,i=!0),h=0<f,g=j.csioAvgBRKbps-k.prevCsioAvgBRKbps,k.prevCsioAvgBRKbps=j.csioAvgBRKbps,c(j,f,g,h,i))})}}function e(){return window.performance.now?window.performance.now():null}function f(){navigator&&"function"==typeof navigator.getBattery&&navigator.getBattery().then(function(a){Xa=a})}function g(){if(Xa)return Xa.level}function h(){if(Xa)return Xa.charging}function i(a,b){return a.sort().toString()===b.sort().toString()}function j(a,b,c){navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&navigator.mediaDevices.enumerateDevices().then(function(d){la?i(la,d)||(la=d,_b(a,b,c)):(la=d,_b(a,b,c)),setTimeout(function(){j(a,b,c)},sa)}).catch(function(){setTimeout(function(){j(a,b,c)},sa)})}function k(){Z&&Z().then(function(a){ka=JSON.parse(a),setTimeout(function(){k()},ta)}).catch(function(){setTimeout(function(){k()},ta)})}function l(){qa||window&&window.addEventListener&&window.addEventListener("beforeunload",function(a){var b;for(b in ab)ab.hasOwnProperty(b)&&Xb(jb.userLeft,null,b,ab[b].ucID,null,null,null);return cb&&(bb.offsetResults=[],bb.syncHandler=null,cb=!1),"Are you sure you want to close the call?"})}function m(a,b,c,d,f){var g=kc(c,d),h=null;g&&(h=e(),Xb(jb.mediaPlaybackStartEvent,b,c,a,{ssrc:f,highResTs:h},g,null))}function n(a,b,c,d,f){var g=kc(c,d),h=null;g&&(h=e(),Xb(jb.mediaSuspendedEvent,b,c,a,{ssrc:f,highResTs:h},g,null))}function o(a,b,c,d){var e,f=document.getElementById(b);f&&(f.oncanplay=function(){e=ab[a].ucID;var b=jc(a,c);b&&m(e,b.remoteUserID,a,c,d)},f.onsuspend=function(){e=ab[a].ucID;var b=jc(a,c);b&&n(e,b.remoteUserID,a,c,d)})}function p(a){var b=Aa.codebase,c=!1;if(null===a)c=!1;else if(b===Fb.firefox){var d=typeof mozRTCPeerConnection,e=typeof RTCPeerConnection;"undefined"!==d&&a instanceof mozRTCPeerConnection?c=!0:"undefined"!==e&&a instanceof RTCPeerConnection&&(c=!0)}else null!==hb&&a instanceof hb&&(c=!0),"function"!=typeof a&&b!==Fb.edge||(c=!0),void 0!==typeof a.createOffer&&(c=!0);return c}function q(a,b){var c;return a&&(b===Fb.chrome?a.googLocalAddress?(c=a.googLocalAddress,c.concat(":",a.googRemoteAddress)):a.selectedCandidatePairId&&(c=a.selectedCandidatePairId):b===Fb.firefox&&(a.localAddr?(c=a.localAddr,c.concat(":",a.remoteAddr)):a.selectedCandidatePairId&&(c=a.selectedCandidatePairId))),cc(c)}function r(){var a;return a=navigator.onLine===!0?"online":"offline"}function s(a,b,c){var d=null;c.ssrcMap.hasOwnProperty(a.data.ssrc)&&(c.ssrcMap[a.data.ssrc].mediaType=a.data.mediaType,a.data.googCodecName?d=a.data.googCodecName:a.data.codec&&(d=a.data.codec),c.ssrcMap[a.data.ssrc].codec=d,a.data.codecImplementationName&&(c.ssrcMap[a.data.ssrc].codecImplementationName=a.data.codecImplementationName))}function t(a,b,c){var d,e,f,g,h,i,j,k,l=[];if(void 0!==a.lastStatsSent&&void 0!==a.lastStatsSent.statistics.Transport)for(f=a.lastStatsSent.statistics.Transport,g=a.latestEventSent,h=void 0,d=0;d<b.length;d++){for(h=void 0,e=0;e<f.length;e++)if(b[d].hash===f[e].hash){h=f[e];break}void 0!==h&&(i=parseInt(h.bytesReceived,10),j=parseInt(h.bytesSent,10),k=c-g,k>0&&(b[d].csioReceivedBwKbps=8*(parseInt(b[d].bytesReceived,10)-i)/k,b[d].csioSentBwKbps=8*(parseInt(b[d].bytesSent,10)-j)/k,b[d].csioIntBytesReceived=parseInt(b[d].bytesReceived,10)-i,b[d].csioIntBytesSent=parseInt(b[d].bytesSent,10)-j,void 0!==h.packetsSent&&void 0!==b[d].packetsSent&&(b[d].csioSentPacketRate=(parseInt(b[d].packetsSent,10)-parseInt(h.packetsSent,10))/(k/1e3),b[d].csioIntPacketsSent=parseInt(b[d].packetsSent,10)-parseInt(h.packetsSent,10)),void 0!==h.packetsReceived&&void 0!==b[d].packetsReceived&&(b[d].csioReceivedPacketRate=(parseInt(b[d].packetsReceived,10)-parseInt(h.packetsReceived,10))/(k/1e3),b[d].csioIntPacketsReceived=parseInt(b[d].packetsReceived,10)-parseInt(h.packetsReceived,10))),l.push(b[d]))}return l}function u(a,b,c,d){var e=[];return c===Fb.firefox?e=b:b&&(e=t(a,b,d)),e}function v(a){var b,c,d;for(b in a.streams)if(a.streams.hasOwnProperty(b)){if(a.streams[b].inbound)for(d in a.streams[b].inbound)a.streams[b].inbound.hasOwnProperty(d)&&(c=a.streams[b].inbound[d].mark,c===wb.bad?a.streams[b].inbound[d].mark=2:c===wb.fair?a.streams[b].inbound[d].mark=1:a.streams[b].inbound[d].mark=0);if(a.streams[b].outbound)for(d in a.streams[b].outbound)a.streams[b].outbound.hasOwnProperty(d)&&(c=a.streams[b].outbound[d].mark,c===wb.bad?a.streams[b].outbound[d].mark=2:c===wb.fair?a.streams[b].outbound[d].mark=1:a.streams[b].outbound[d].mark=0)}return a}function w(a){var b={},c=od.getConferenceURL();return a.connectionState&&(b.connectionState=a.connectionState),a.fabricState&&(b.fabricState=a.fabricState),c&&(b.conferenceURL=c),b.streams={},null===a.streams?b:(a.streams.forEach(function(a){var c={cname:a.cname,ssrc:a.ssrc,msid:a.msid,remoteUserID:a.userID,usageLabel:a.usage,associatedVideoTag:a.associatedVideoTag};a.data.hasOwnProperty("csioIntFL")&&(c.fractionLoss=a.data.csioIntFL),a.data.hasOwnProperty("csioIntBRKbps")&&(c.bitrate=a.data.csioIntBRKbps),a.data.hasOwnProperty("csioMark")&&(c.quality=a.data.csioMark),a.data.hasOwnProperty("csioMediaType")&&(c.mediaType=a.data.csioMediaType),a.data.hasOwnProperty("googRtt")&&(c.rtt=a.data.googRtt),a.data.hasOwnProperty("mozRtt")&&(c.rtt=a.data.mozRtt),a.data.hasOwnProperty("roundTripTime")&&(c.rtt=a.data.roundTripTime),a.data.hasOwnProperty("jitter")&&(c.jitter=a.data.jitter),a.data.hasOwnProperty("googJitterReceived")&&(c.jitter=a.data.googJitterReceived),a.data.hasOwnProperty("audioOutputLevel")&&(c.audioOutputLevel=a.data.audioOutputLevel),a.data.hasOwnProperty("audioInputLevel")&&(c.audioInputLevel=a.data.audioInputLevel),a.data.hasOwnProperty("audioLevel")&&(c.audioLevel=a.data.audioLevel),a.data.hasOwnProperty("csioAvgRtt")&&(c.averageRTT=a.data.csioAvgRtt),a.data.hasOwnProperty("csioAvgJitter")&&(c.averageJitter=a.data.csioAvgJitter),a.data.hasOwnProperty("csioPktLossPercentage")&&(c.packetLossPercentage=a.data.csioPktLossPercentage),a.reportType&&"local"===a.reportType?a.streamType&&(c.statsType=a.streamType+"-rtp"):a.reportType&&"remote"===a.reportType&&a.streamType&&(c.statsType="remote-"+a.streamType+"-rtp"),b.streams[a.ssrc]=c}),b)}function x(a,b,d,e,f,g){var h=c();a.hasOwnProperty("token")&&a.hasOwnProperty("ucID")&&!cb?(S(kb.processedStats,a,g),b.latestEventSent=h,b.lastFabricState=b.pcState):(a.clockUnsynced=cb,Oa.cacheEvent({channel:kb.processedStats,data:a}))}function y(a,b){for(var c in b)b.hasOwnProperty(c)&&"id"!==c&&"type"!==c&&"timestamp"!==c&&(a[c]=b[c]);return a}function z(a,e,f,i,j){function k(k){if(k){var l=c(),m=b();void 0===i.lastRawStatsSentInterval||null===i.lastRawStatsSentInterval?i.lastRawStatsSentInterval=m-i.statsPollingStart:i.lastRawStatsSentInterval=m-i.rawstatsTS+i.lastRawStatsSentInterval,void 0===i.lastProcessedStatsSentInterval||null===i.lastProcessedStatsSentInterval?i.lastProcessedStatsSentInterval=Fa+1:i.lastProcessedStatsSentInterval=m-i.rawstatsTS+i.lastProcessedStatsSentInterval,i.rawstatsTS=m;var n={},o=Aa.codebase,p=i.conferenceID,t=i.remoteUserID;n.version=da,n.appID=ma,n.conferenceID=encodeURIComponent(p),n.apiTS=l,n.timeShift=0,n.fabricState=i.pcState,n.pcID=i.pcHash,void 0!==f&&(n.ucID=f),Ua.authToken&&(n.token=Ua.authToken),n.localID=encodeURIComponent(e),n.remoteID=t?encodeURIComponent(t):null,n.deviceID=pa;var y,z,A,C,G,H,J,K={streams:[]},L=null,M=!1,N=!1,O={},P={};for(L=nc(k),y=0;y<L.length;++y)if(z=E(L[y]),A=B(z),!F(A))if(A.hasOwnProperty("Transport"))C="Transport",K.hasOwnProperty(C)||(K[C]=[]),o!==Fb.firefox?(parseInt(A[C].bytesReceived,10)>0||parseInt(A[C].bytesSent,10)>0)&&(K[C].push(A[C]),"true"!==A[C].googActiveConnection&&A[C].googActiveConnection!==!0||(n.activeConnectionIndex=K[C].length)):(K[C].push(A[C]),"true"!==A[C].selected&&A[C].selected!==!0||(n.activeConnectionIndex=K[C].length));else if(A.localCandidate)O[A.localCandidate.id]=A.localCandidate;else if(A.remoteCandidate)P[A.remoteCandidate.id]=A.remoteCandidate;else if(A.bwe)K.bwe=A.bwe;else if(A.trackStats)K.trackStats||(K.trackStats=[]),K.trackStats.push(A.trackStats);else if(A.codec)K.codec||(K.codec=[]),K.codec.push(A.codec);else if(A.candidatePair)K.candidatePair||(K.candidatePair=[]),K.candidatePair.push(A.candidatePair);else{H=Ub(i,A.ssrc),void 0!==H&&H.localStartTime||(J=Wb(t,p,f,i,j,null),J&&(N=!0),H=Ub(i,A.ssrc)),H&&(G=H.remoteUserID),void 0===G&&(G=t);var Q={userID:G,data:A.data,reportType:A.reportType,streamType:A.streamType,ssrc:A.ssrc};void 0!==H&&(Q.cname=H.cname,Q.msid=H.msid,Q.associatedVideoTag=H.associatedVideoTag,Q.usage=H.usageLabel),K.streams.push(Q)}if(n.statistics=K,K.Transport&&(M=D(K.Transport,i)),M&&cd(j,jb.fabricTransportSwitch,p),K.Transport||o!==Fb.firefox||(K.Transport=K.candidatePair.filter(function(a){return!(!a.selected&&"true"!==a.selected)})),K.Transport)for(var R=0;R<K.Transport.length;R++)K.Transport[R].hash=q(K.Transport[R],o);i.pcState===xb.disrupted&&I(n),K.trackStats&&(K=hd(K)),K.Transport&&K.candidatePair&&(K=gd(K)),N&&Xb(jb.ssrcMap,t,p,f,Vb(i),i.pcHash),Za&&(Xb(kb.senderConfiguration,t,p,f,$a,i.pcHash),Za=!1);var S={},T={response:null},V={response:null},W={response:null},X=null;if(ja.fire(ja.events.OnPolling,{streams:K.streams,codeBase:o}),ja.fire(ja.events.OnOneWayAudioDisruptionsRequest,V),null!==V.response&&V.response.forEach(function(a){X={mediaType:a.mediaType,ssrc:a.ssrc,disruptionType:a.type},Xb(jb.oneWayMedia,t,p,f,X,i.pcHash)}),ja.fire(ja.events.OnSendingThroughputObservationsRequest,W),null!==W.response&&(X=W.response,Xb(kb.sendingThroughputObservations,t,p,f,X,i.pcHash)),ja.fire(ja.events.OnStatsRequest,T),null!==T.response){if(T.response.streams)for(y=0;y<T.response.streams.length;y++)s(T.response.streams[y],o,i);S.streams=T.response.streams;for(var Y=0<Ma.length,Z=0,$=function(a){a.data.ssrc===Z&&(Y|="audio"===a.mediaType&&a.streamType===ub.inbound)};0<Ma.length;)Z=Ma.shift(),S.streams.forEach($);if(Y){var _={mediaType:"audio",ssrc:null,disruptionType:vb.noInboundAudioOnlyFabric};Xb(jb.oneWayMedia,t,p,f,_,i.pcHash)}if(S.fabricState=i.pcState,S.connectionState=r(),K.Transport&&(S.Transport=u(i,K.Transport,o,l)),K.bwe&&(S.bwe=K.bwe),void 0===i.processedStatsTupleArray&&(i.processedStatsTupleArray=[]),Da.stats){var aa=w(S);Da.stats(aa)}S.apiTS=l,S.batteryStatus={},S.batteryStatus.batteryLevel=g(),S.batteryStatus.isBatteryCharging=h(),S.wifiStats=ka,S=v(S),d(S),i.processedStatsTupleArray.push(S),n.processedStatistics=i.processedStatsTupleArray,i.lastStatsSent=n;var ba=U(n);delete ba.statistics,i.lastProcessedStatsSentInterval>=Fa&&(i.processedStatsTupleArray=[],Ra.add(ba,ba.processedStatistics.length),ba.msgStat=Ra.getStat(),x(ba,i,p,t,e,a),i.lastProcessedStatsSentInterval=0)}}}return k}function A(a){var b;return yb.hasOwnProperty(a)?a===yb.createOffer||a===yb.createAnswer||a===yb.setRemoteDescription?b=zb.negotiationFailure:a===yb.setLocalDescription?b=zb.sdpError:a===yb.addIceCandidate?b=zb.sdpError:a===yb.getUserMedia?b=zb.mediaConfigError:a===yb.iceConnectionFailure?b=zb.iceFailure:a===yb.signalingError?b=zb.signalingError:(a===yb.applicationLog||yb.applicationError)&&(b=zb.applicationLog):b=Pb.invalidWebRTCFunctionName,b}function B(a){var b={};if("inboundrtp"===a.type||"outboundrtp"===a.type||"inbound-rtp"===a.type||"outbound-rtp"===a.type){if(b.ssrc=a.ssrc,b.streamType="inboundrtp"===a.type||"inbound-rtp"===a.type?"inbound":"outbound","Safari"===Aa.name&&!a.mediaType){a.id.includes("Audio")?a.mediaType="audio":a.id.includes("Video")&&(a.mediaType="video");var c=a.id.split("_");if(c[1])try{a.ssrc=parseInt(c[1]),b.ssrc=a.ssrc}catch(a){}}b.data=a,void 0!==a.isRemote?b.reportType="true"===a.isRemote||a.isRemote===!0?"remote":"local":b.reportType="local",a.trackId&&(b.trackId=a.trackId),a.mediaType&&(b.mediaType=a.mediaType)}else"candidatepair"===a.type&&a.selected?b.Transport=a:"localcandidate"===a.type||"local-candidate"===a.type?b.localCandidate=a:"remotecandidate"===a.type||"remote-candidate"===a.type?b.remoteCandidate=a:"transport"===a.type||"googCandidatePair"===a.type?b.Transport=a:"VideoBwe"===a.type?b.bwe=a:"track"===a.type?b.trackStats=a:"candidate-pair"===a.type?b.candidatePair=a:"codec"===a.type?b.codec=a:"ssrc"===a.type&&(b.reportType="local",a.bytesSent?b.streamType="outbound":b.streamType="inbound",b.ssrc=a.ssrc,b.data=a);return b}function C(a){var b="None";switch(a){case 0:b="TURN/TLS";break;case 1:b="TURN/TCP";break;case 2:b="TURN/UDP"}return b}function D(a,b){var c,d,e,f,g,h,i,j,k,l=!1,m="None",n=!1,o=Aa.codebase,p=function(a){if(a.typePreference){var b=a.typePreference>>24;return"rtp"===a.protocol&&a.address===c&&(b>=0&&b<=2&&(m=C(b)),!0)}return!1};for(i=0;i<a.length;i++)if(j=a[i],o!==Fb.firefox||"candidatepair"!==j.type||"true"!==j.selected&&j.selected!==!0?"googCandidatePair"!==j.type||"true"!==j.googActiveConnection&&j.googActiveConnection!==!0?"transport"===j.type&&(n=!0,j.selectedCandidatePairId&&(k=j.selectedCandidatePairId)):(n=!0,c=j.googLocalAddress,d=j.googRemoteAddress,e=j.googLocalCandidateType,f=j.googRemoteCandidateType,g=j.googTransportType):(n=!0,c=j.localAddr,d=j.remoteAddr,e=j.localAddrType,f=j.remoteAddrType,g=j.transportType),n){c&&(h=0===c.indexOf("[")),b.iceCandidates.some(p);break}if(!n)return l;var q=b.transportData;return void 0!==q&&q.localAddr===c&&q.remoteAddr===d&&q.transportType===g&&q.selectedCandidatePairId===k||(b.transportData={localAddr:c,remoteAddr:d,localAddrType:e,remoteAddrType:f,transportType:g,ipv6:h,relayType:m,selectedCandidatePairId:k},l=!0),l}function E(a){var b,c={};a.timestamp instanceof Date&&(c.timestamp=a.timestamp.getTime().toString()),a.type&&(c.type=a.type);var d=0;if(a.names){var e=a.names();for(d=0;d<e.length;++d)c[e[d]]=a.stat(e[d])}else for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);if(c.values){for(d=0;d<c.values.length;++d){a=c.values[d];for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b])}delete c.values}return c}function F(a){if(null===a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;var b;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}function G(a){return{magicKey:a,statsSubmissionInterval:Fa,endpoint:Ya,localUserIDObject:oa}}function H(a,b,c){var d=ab[a];void 0===d&&(ab[a]={},ab[a].participants=null,c&&(ab[a].userJoinedSent=!0),b&&(ab[a].refreshPresence=b))}function I(a){var b,c=a.statistics.outbound;if(void 0!==c)for(b in c)c.hasOwnProperty(b)&&(c[b].data.mozRtt?c[b].data.mozRtt=0:c[b].data.googRtt?c[b].data.googRtt=0:c[b].data.rtt?c[b].data.rtt=0:c[b].data.roundTripTime&&(c[b].data.roundTripTime=0))}function J(a){return clearInterval(a),null}function K(){var a;for(a in ab)ab.hasOwnProperty(a)&&(ab[a].refreshPresence=J(ab[a].refreshPresence),delete ab[a].refreshPresence);W()}function L(a){var b=!1;if(!a)return b;var c=ab[a];return void 0!==c&&c.participants&&c.participants.length>0&&(b=!0),b}function M(a,b){var c=ab[a],d=[];if(void 0===c)d.push(b),ab[a]={},ab[a].participants=d;else{var e=c.participants;null===e?(d.push(b),c.participants=d):e.push(b)}}function N(a){var b=!1;if(!ab[a])return{conferenceFinished:b,ucID:null};var c=ab[a].ucID;return 0===ab[a].participants.length&&(J(ab[a].refreshPresence),W(),Oa.sendCachedEvents(Ua,cb),delete ab[a],b=!0),{conferenceFinished:b,ucID:c}}function O(a,b){Xb(jb.userLeft,null,a,b,null,null,null),W(),db=Rb,Rb=null}function P(){var a,b=function(a){return setInterval(function(){ac(a)},Ha)};for(a in ab)if(ab.hasOwnProperty(a)){if(a===ia)return;ac(a),ab[a].refreshPresence=b(a)}X()}function Q(){bb.syncHandler||(Ob(ma,na,"log",{msg:"start clockSync"}),bb.offsetResults=[],ld(),bb.syncHandler=!0)}function R(a){try{if(window&&window.sessionStorage){var b=JSON.parse(window.sessionStorage.getItem("csio_ucid_data"));if(b&&b[a])return b[a].ucID}}catch(a){return null}return null}function S(a,b,c){var d=b.action,e=b.remoteID,f=b.ucID;b.channel=a,Ua._isTokenValid(Ua.authToken,ma,na)?(f&&!cb&&e||Hb.indexOf(d)!==-1)&&b.conferenceID!==ia?(b.token=Ua.authToken,pd(a,b,c),c&&d&&c(nb.success,d+" sent to the backend.")):(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})):Ua.sendAuthenticationRequest(ma,na,function(g,h){g!==nb.success?(g===ob.authOngoing&&(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})),c&&g!==ob.authOngoing&&c(g,h)):g===nb.success&&"SDK authentication successful."===h&&((f&&!cb&&e||Hb.indexOf(d)!==-1)&&b.conferenceID!==ia?(b.token=Ua.authToken,pd(a,b,c),c&&d&&c(nb.success,d+" sent to the backend.")):(b.clockUnsynced=cb,Oa.cacheEvent({channel:a,data:b,callback:c})))})}function T(a){a&&a(ob.authOngoing,"Authentication Ongoing")}function U(a){var b;if(null===a||"object"!=typeof a)return a;if(a instanceof Array){b=[];for(var c=0,d=a.length;c<d;c++)b[c]=U(a[c]);return b}if(a instanceof Object){b={};for(var e in a)a.hasOwnProperty(e)&&(b[e]=U(a[e]));return b}}function V(){var a={};Object.keys(ab).forEach(function(b){var c=ab[b];if(!c)return!0;var d,e,f={ucID:c.ucID,userJoinedSent:c.userJoinedSent},g=[];if(c.participants){var h,i=c.participants;for(d=0;d<i.length;d++)e={},h=i[d],e={pcID:h.pcHash,pcState:h.pcState,iceConnectionState:h.iceConnectionState,iceGatheringState:h.iceGatheringState,iceCandidatesNumber:h.iceCandidates.length,remoteUserID:h.remoteUserID},g.push(e)}f.participants=g,a[b]=f});var b={authStatus:!!Ua.tokenData,clockSync:!cb,stateMachine:a,pageURL:window.location.href,eventType:"warn",version:da};b.wsStatus=od.getWSConnectionState(),Ob(ma,na,"stateMachine",b)}function W(){eb||(eb=setInterval(function(){V()},fb))}function X(){J(eb),eb=null}function Y(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var b,c=Object(this),d=c.length>>>0,e=arguments[1],f=0;f<d;f++)if(b=c[f],a.call(e,b,f,c))return b}})}var Z,$=require("./callstatsUtils"),_=require("./statsReporter"),aa=require("./pcCallbackHandler"),ba="@@jsURL",ca="@@authServiceURL",da="@@jsVersion",ea="@@wsURL",fa="@@conferenceBaseURL",ga="@@qmodelThresholdsAPIUrl",ha="@@configServiceURL",ia="csio-conf-id-tmp",ja=new _.Reporter,ka=null;window&&(window.csioChromeLegacyGetStats=!0);var la,ma=null,na=null,oa=null,pa=null,qa=!1,ra=!1,sa=1e4,ta=1e4,ua=1e3,va="",wa=function(a,b){var c="precalltest error ("+a+"): "+b;console.warn(c),Ob&&Ob(ma,na,"log",{msg:c}),va+="(error)"},xa=require("precalltest"),ya=null;try{ya=new xa.PreCallTest}catch(a){wa("initializing",a)}var za,Aa,Ba=[],Ca={create:Date.now()},Da={stats:null,defaultConfig:null,recommendedConfig:null,preCallTest:null},Ea=2e4,Fa=15e3,Ga=!1,Ha=1e4,Ia=5e3,Ja=2e3,Ka=!0,La=!0,Ma=[],Na=function(){function a(a,b){setTimeout(function(){var b=c(),d=b-a.data.apiTS;a.data.timeShift=d,S(a.channel,a.data,a.callback)},b)}this.eventCache=[],this.updateRemoteUserID=function(a,b){for(var c,d=this,e=0;e<d.eventCache.length;e++)c=d.eventCache[e],c.data.pcID===b&&(c.data.remoteID=a)},this.sendCachedEvents=function(b,d,e,f,g,h){var i=this;if(0!==i.eventCache.length){if(!b.authToken)return void b.sendAuthenticationRequest(ma,na);if(!d){var j,k,l,m,n=c(),o=[],p=Math.max(Fa/i.eventCache.length,gb);for(j=0;j<i.eventCache.length;j++)if(l=i.eventCache[j],!l.data.remoteID&&l.data.pcID||l.data.conferenceID===ia)o.push(i.eventCache[j]);else if(l.data.action!==jb.userJoined){if(l.data.token=b.authToken,e&&l.data.apiTS>=n-f||!l.data.ucID)if(m=decodeURIComponent(l.data.conferenceID),ab[m]&&ab[m].ucID)l.data.ucID=ab[m].ucID;else{if(m!==g){o.push(i.eventCache[j]);continue}l.data.ucID=h}if(l.data.clockUnsynced&&(l.data.apiTS+=bb.currentOffset),l.channel===kb.processedStats&&l.data.clockUnsynced&&l.data.processedStatistics&&l.data.processedStatistics.length>0)for(k=0;k<l.data.processedStatistics.length;k++)l.data.processedStatistics[k].apiTS+=bb.currentOffset;delete l.data.clockUnsynced,a(l,p*(j+1))}else o.push(i.eventCache[j]);i.eventCache=o}}},this.sendCachedUserJoinedEvents=function(b){var c=this;if(0!==c.eventCache.length){if(!b.authToken)return void b.sendAuthenticationRequest(ma,na);var d,e,f=[],g=Math.max(Fa/c.eventCache.length,gb);for(d=0;d<c.eventCache.length;d++)e=c.eventCache[d],!e.data.remoteID&&e.data.pcID||e.data.conferenceID===ia?f.push(c.eventCache[d]):e.data.action===jb.userJoined||e.data.action===ib.fabricSetupFailed?(e.data.token=b.authToken,e.data.clockUnsynced&&(e.data.apiTS=e.data.apiTS+bb.currentOffset),e.data.value&&(e.data.value.statsSubmissionInterval=Fa),a(e,g*(d+1))):f.push(c.eventCache[d]);c.eventCache=f}},this.updateConferenceId=function(a){for(var b,c=this,d=0;d<c.eventCache.length;d++)b=c.eventCache[d],b.data.conferenceID===ia&&(b.data.conferenceID=a)},this.cacheEvent=function(a){this.eventCache.push(a)},this.sendCachedFeedback=function(){var a=Jb("feedback"),b=JSON.parse(Jb("csio_auth_data"));if(a&&b){var c=JSON.parse(a),d=b===c.token;d||na!==c.userID||(c.token=b,d=!0),d?S(kb.userFeedback,c):Kb("feedback")}}},Oa=new Na,Pa=function(){this.size_max=0,this.size_ewma=0,this.statNum_max=0,this.statNum_ewma=0,this.msg_num=0,this.maxInterval=0,this.minInterval=0,this.avgInterval=0,this.stdInterval=0},Qa=function(){this.stat=new Pa,this.lastTime=null,this.samplesCount=0,this.add=function(a,c){var d=this.memorySizeOf(a);if(this.stat.size_ewma=.5*this.stat.size_ewma+.5*d,this.stat.size_max<d&&(this.stat.size_max=d),this.stat.statNum_ewma=.5*this.stat.statNum_ewma+.5*c,this.stat.statNum_max<c&&(this.stat.statNum_max=c),this.stat.msg_num+=1,null===this.lastTime)return void(this.lastTime=b());var e=b()-this.lastTime;this.lastTime=b(),(0===this.stat.maxInterval||this.stat.maxInterval<e)&&(this.maxInterval=e),(0===this.stat.minInterval||e<this.stat.minInterval)&&(this.minInterval=e),this.stat.avgInterval=(this.stat.avgInterval*this.samplesCount+e)/(this.samplesCount+c),this.samplesCount+=c,this.stat.stdInterval=(31*this.stat.stdInterval+Math.abs(this.stat.avgInterval-e))/32},this.getStat=function(){return this.stat},this.memorySizeOf=function(a){function b(a){if(null!==a&&void 0!==a)switch(typeof a){case"number":c+=8;break;case"string":c+=2*a.length;break;case"boolean":c+=4;break;case"object":var d=Object.prototype.toString.call(a).slice(8,-1);if("Object"===d||"Array"===d)for(var e in a)a.hasOwnProperty(e)&&b(a[e]);else c+=2*a.toString().length}return c}var c=0;return b(a)}},Ra=new Qa,Sa={appSecret:"appSecret",jwt:"jwt"},Ta=function(){var a=this,b="urn:x-callstats:auth:errorActions",d=.9;this.authInProgress=!1,this.tokenData=null,this.authToken=null,this.type=Sa.appSecret,this.tokenGenerator=function(a,b){b("Token generator not set")};var e=null,f=null,g=!1,h=window.atob,i=window.btoa,j=["Authentication Internal Error","Invalid Credentials","Invalid Credentials","Invalid Credentials","Invalid Credentials","Origin URL missmatch","Invalid Credentials","Authentication Protocol Error"],k=function(a){return i(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode("0x"+b)}))},l=function(a){return i(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},m=function(a){return k(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},n=function(a){for(var b=h(a.replace(/[ \r\n]+$/,"")),c=[],d=0;d<b.length;++d){var e=b.charCodeAt(d).toString(16);1===e.length&&(e="0"+e),c.push(e)}return c.join("")},o={};o.cryptotype=null,window.crypto&&window.crypto.subtle?(o.cryptotype="standard",o.subtlecrypto=window.crypto.subtle):window.crypto&&!window.crypto.subtle&&window.crypto.webkitSubtle?(o.cryptotype="webkit",o.subtlecrypto=window.crypto.webkitSubtle):window.msCrypto&&window.msCrypto.subtle?(o.cryptotype="ie",o.subtlecrypto=window.msCrypto.subtle):(o.subtlecrypto=null,console.info("WebCryptography API not supported in this browser.")),o.sign=function(a,b,c,d){if("HS256"!==a.alg)return d("Use header.alg=HS256");a=JSON.stringify(a),"string"!=typeof b&&(b=JSON.stringify(b));var e=m(a)+"."+m(b);if(window.csioReactNative)return void window.csiosign(e,c,function(a,b){return a?(console.log("Token sign error",a),d(a)):d(null,b)});for(var f=new ArrayBuffer(e.length),g=new Uint8Array(f),h=e.length-1;h>=0;h--)g[h]=e.charCodeAt(h);var i=function(a){for(var b="",c=new Uint8Array(a),f=c.byteLength,g=0;g<f;g++)b+=String.fromCharCode(c[g]);return e+="."+l(b),d(null,e)},j=function(a){return d(a)},k={name:"HMAC"};"ie"!==o.cryptotype&&"webkit"!==o.cryptotype||(k.hash={name:"sha-256"});var n=o.subtlecrypto.sign(k,c,g);"ie"===o.cryptotype?(n.onerror=j,n.oncomplete=function(a){i(a.target.result)}):n.then(i).catch(j)},o.decode=function(a){try{return JSON.parse(h(a.split(".")[1]))}catch(a){return console.error("Couldn't decode token. ",a),null}},o.importKey=function(a,b,c){if(window.csioReactNative)return void b(a);if("webkit"===o.cryptotype)for(;a.length<32;)a+="\0";var d={kty:"oct",k:l(a),alg:"HS256"},e={name:"HMAC",hash:{name:"SHA-256"}};if("ie"===o.cryptotype?d.extractable=!1:d.ext=!1,"webkit"===o.cryptotype&&(e=null,d.use="sig"),"ie"===o.cryptotype||"webkit"===o.cryptotype){var f=JSON.stringify(d);d=new Uint8Array(f.length);for(var g=0;g<f.length;g++)d[g]=f.charCodeAt(g)}var h=o.subtlecrypto.importKey("jwk",d,e,!1,["sign"]);"ie"===o.cryptotype?(h.onerror=c,h.oncomplete=function(a){b(a.target.result)}):h.then(b).catch(c)},this.setAuthType=function(a){this.type=a},this._isTokenValid=function(a,b,d){var e=!1,f=Aa.codebase;if(null===a)return!1;try{var g=o.decode(a);if(null!==g&&g.appID===b&&g.userID===encodeURIComponent(d)){var h=null;if(f===Fb.firefox){var i=g.expiry.split(" ").join("T");h=Date.parse(i)}else h=new Date(g.expiry);var j=new Date(c());j<h&&(e=!0)}return e}catch(a){}return!1},this.setupAuthToken=function(a){Ib("csio_auth_data",JSON.stringify(a)),this.authToken=a,this.tokenData=o.decode(a),Fa=parseInt(this.tokenData.submissionInterval,10),ja.setSubmissionInterval(Fa),ja.setReportingMode(this.tokenData.adaptiveInterval),Ga=this.tokenData.collectSDP},this.sendAuthenticationRequest=function(c,f,h){if(c&&f){if(a.authInProgress)return void T(h);null!==e&&(clearTimeout(e),e=null),p(),a.authInProgress=!0,a.tokenGenerator(g,function(i,j){if(null!==i)return a.authInProgress=!1,void(h&&h(nb.tokenGenerationError,i.toString()));var k=ca+"authenticate",l={client_id:f+"@"+ma,code:j,grant_type:"authorization_code"};jd(k,l,function(i,j){var k=null;a.authInProgress=!1,Ca.auth=j;try{k=JSON.parse(i.response)}catch(a){console.error("Authentication response parse error")}if(!k)return void(e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h));if(200===i.status){if("bearer"!==k.token_type)return console.error("Authentication was successful, but token type was not bearer. Scheduling retry."),void(e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h));a.setupAuthToken(k.access_token);var l=parseInt(1e3*parseInt(k.expires_in)*d);if(q(l,c,f,h),g=!1,h&&h(nb.success,"SDK authentication successful."),k.iceServers&&!ra&&ya)try{va=k.iceServers[0].username+" ",ya.start(k.iceServers,gc.bind(this)),Ob(ma,na,"log",{msg:"precalltest started "+va}),va+="(started)"}catch(a){wa("start",a),ya.crashDisconnect()}ra&&(Ob(ma,na,"log",{msg:"precalltest disabled "+va}),va+="(disabled)"),hc(),od._isChannelReady()?(Oa.sendCachedUserJoinedEvents(Ua),h&&h(nb.success,"WebSocket establishment successful.")):od._setupWebSocketConnection(function(a,b){h&&h(a,b)})}else{if(k[b]&&k[b].length>0)return r(c,f,h,k[b],a.type);console.error("Authentication failed, but no error actions were defined in response."),e=setTimeout(a.sendAuthenticationRequest,Ia,c,f,h)}})})}};var p=function(){null!==f&&(clearTimeout(f),f=null)},q=function(b,c,d,e){p(),f=setTimeout(function(){a.sendAuthenticationRequest(c,d,e)},b)},r=function(a,b,c,d,e){if(0!==d.length){var f=d.shift();if(f.action===Qb.RETRY)return e===Sa.jwt&&q(f.params.timeout,a,b,c),r(a,b,c,d);if(f.action===Qb.GET_NEW_TOKEN)return g=!0,r(a,b,c,d);if(f.action===Qb.REPORT_ERROR){var h="Authentication Error";return f.params&&f.params.errorCode>=0&&(h=j[f.params.errorCode]),c&&c(nb.authError,h),r(a,b,c,d)}}};this.appSecretTokenGenerator=function(b){var c=null,d=null,e=!1,f=null;b.indexOf(":")>-1&&(f=n(b.split(":")[0]),b=b.split(":")[1]);var g=function(a){b=null,c=a},h=function(a){e=!0,b=null,console.error("Couldn't import key",a)};return o.importKey(b,g,h),function(b,g){if(e)return g("appsecret based token generation failed");if(!b&&null!==d)return g(null,d);if(null===c)return setTimeout(function(){a.tokenGenerator(b,g)},100);var h={userID:na,appID:ma};f&&(h.keyID=f),o.sign({alg:"HS256"},h,c,function(a,b){return a?g(a):(d=b,g(null,b))})}}},Ua=new Ta,Va=new $;try{Aa=Va.detectBrowserInfo()}catch(a){console.log("detectBrowserInfo: Error",a)}var Wa;window.csioReactNative||(Wa=Va.measureAppLoadingPerformance(Aa),Ca.loading=Wa);var Xa,Ya={type:"browser",name:Aa.name,ver:Aa.ver,os:Aa.os,osVersion:Aa.osVersion,userAgent:Aa.userAgent},Za=!1,$a=null,_a=null,ab={},bb={currentOffset:0,offsetResults:[],syncStartTime:null,syncAttempts:5,syncHandler:null,maxAllowedLatency:6e4},cb=!0,db=null,eb=null,fb=2e4,gb=100,hb=null;"Firefox"===Aa.name?hb=mozRTCPeerConnection:"Chrome"===Aa.name||"Opera"===Aa.name?hb=webkitRTCPeerConnection:"Safari"===Aa.name?console.log("Browser type Safari"):"Edge"===Aa.name&&(hb=window.RTCPeerConnection);var ib={fabricSetupFailed:"fabricSetupFailed",fabricHold:"fabricHold",fabricResume:"fabricResume",audioMute:"audioMute",audioUnmute:"audioUnmute",videoPause:"videoPause",videoResume:"videoResume",fabricUsageEvent:"fabricUsageEvent",fabricTerminated:"fabricTerminated",screenShareStart:"screenShareStart",screenShareStop:"screenShareStop",dominantSpeaker:"dominantSpeaker",userIDChangedEvent:"userIDChangedEvent",activeDeviceList:"activeDeviceList",applicationErrorLog:"applicationErrorLog"},jb={autoFabricSetup:"autoFabricSetup",userJoined:"userJoined",userLeft:"userLeft",refreshPresence:"userAlive",ssrcMap:"ssrcMap",mediaPlaybackStartEvent:"mediaPlaybackStartEvent",mediaSuspendedEvent:"mediaSuspendedEvent",oneWayMedia:"oneWayMedia",fabricStateChange:"fabricStateChange",iceDisruptionStart:"iceDisruptionStart",iceDisruptionEnd:"iceDisruptionEnd",fabricTransportSwitch:"fabricTransportSwitch",iceConnectionDisruptionStart:"iceConnectionDisruptionStart",iceConnectionDisruptionEnd:"iceConnectionDisruptionEnd",iceAborted:"iceAborted",iceTerminated:"iceTerminated",iceFailed:"iceFailed",iceRestarted:"iceRestarted",fabricDropped:"fabricDropped",connectedDevices:"connectedDevices",iceCompleted:"iceCompleted",iceCandidateFound:"iceCandidateFound"},kb={sdpSubmission:"sdpSubmissionEvent",rtpStats:"rtpStats",processedStats:"processedStats",callStatsEvent:"callStatsEvent",userFeedback:"userFeedbackEvent",clockSync:"clockSync",preCallTest:"preCallTest",senderConfiguration:"senderConfiguration",
sendingThroughputObservations:"sendingThroughputObservations"},lb={results:"preCallTestResults",associate:"preCallTestAssociate"},mb={success:"success",failure:"failure"},nb={httpError:"httpError",authError:"authError",wsChannelFailure:"wsChannelFailure",success:"success",csProtoError:"csProtoError",appConnectivityError:"appConnectivityError",tokenGenerationError:"tokenGenerationError",ok:"OK"},ob={authOngoing:"authOngoing"},pb={peer:"peer",server:"server"},qb={sendonly:"sendonly",receiveonly:"receiveonly",sendrecv:"sendrecv",inactive:"inactive"},rb={audio:"audio",video:"video",data:"data",screen:"screen",multiplex:"multiplex",unbundled:"unbundled"},sb={local:"local",remote:"remote"},tb={excellent:5,good:4,fair:3,poor:2,bad:1},ub={local:"local",remote:"remote",inbound:"inbound",outbound:"outbound"},vb={noAudioInMultiplexFabric:"noAudioInMultiplexFabric",noOutboundAudioOnlyFabric:"noOutboundAudioOnlyFabric",noInboundAudioOnlyFabric:"noInboundAudioOnlyFabric"},wb={excellent:"excellent",fair:"fair",bad:"bad"},xb={established:"established",initializing:"initializing",failed:"failed",disrupted:"disrupted",checkingDisrupted:"checkingDisrupted"},yb={createOffer:"createOffer",createAnswer:"createAnswer",setLocalDescription:"setLocalDescription",setRemoteDescription:"setRemoteDescription",addIceCandidate:"addIceCandidate",getUserMedia:"getUserMedia",iceConnectionFailure:"iceConnectionFailure",signalingError:"signalingError",applicationError:"applicationError",applicationLog:"applicationLog"},zb={mediaConfigError:"MediaConfigError",negotiationFailure:"NegotiationFailure",sdpError:"SDPGenerationError",iceFailure:"IceConnectionFailure",transportFailure:"TransportFailure",signalingError:"SignalingError",applicationError:"ApplicationError",applicationLog:"ApplicationLog"},Ab={video:{gThreshold:1024,rThreshold:256},audio:{gThreshold:30,rThreshold:8}},Bb={video:{gThreshold:.8,rThreshold:.3}},Cb={video:{gThreshold:400,rThreshold:1e3}},Db={video:{gThreshold:10,rThreshold:50},audio:{gThreshold:15,rThreshold:30}},Eb={audio:{gThreshold:240,rThreshold:400}},Fb={chrome:"Chrome",firefox:"Firefox",edge:"Edge"},Gb={signalingState:"signalingState",iceConnectionState:"iceConnectionState",iceGatheringState:"iceGatheringState"},Hb=[jb.userJoined,jb.refreshPresence,ib.fabricSetupFailed],Ib=function(a,b){try{window&&window.localStorage&&window.localStorage.setItem(a,b)}catch(a){return}},Jb=function(a){try{if(window&&window.localStorage)return window.localStorage.getItem(a)}catch(a){return null}return null},Kb=function(a){try{window&&window.localStorage&&window.localStorage.removeItem(a)}catch(a){return}},Lb=function(){if(pa=Jb("endpointID"),null===pa){var a=b(),c=Math.random()*a;Ac(c.toString(),function(a){pa=a,Ib("endpointID",pa)})}},Mb=function(a,c,d,e,f){var g=null,h=null,i=null,j=new XMLHttpRequest;if("Microsoft Internet Explorer"!==Aa.name&&(j.timeout=d),j){j.open("GET",encodeURI(a));for(var k in c)j.setRequestHeader(k,c[k]);g=b(),j.onload=function(){h=b(),i=h-g,e(j,i)},j.ontimeout=f,j.send()}},Nb=function(a,b,c,d){var e=new XMLHttpRequest;if(e){if(e.open("POST",encodeURI(a)),e.setRequestHeader("Content-Type","application/json"),d)for(var f in d)e.setRequestHeader(f,d[f]);e.onload=function(){c(e)},e.send(b)}},Ob=function(a,c,d,e){if(Ka&&a){var f=ba+"generics",g={appID:a,timestamp:b(),userID:encodeURIComponent(c),version:da,eventType:d,data:e},h=JSON.stringify(g);za!==h&&(za=h,Nb(f,h,function(a){200===a.status?console.log("Got generic response: %o",a.response):200!==a.status&&console.log("Got error for generic request %o, %s",a,a.status)}))}};window&&window.addEventListener&&window.addEventListener("error",function(a){if(a&&a.filename&&a.filename.indexOf("callstats")>-1){var b,c=!1,d={fileName:a.filename,line:a.lineno,col:a.colno,jsVersion:da,eventType:"error",message:a.message,pageURL:window.location.href};for(b in ab)ab.hasOwnProperty(b)&&(d.conferenceID=b,Ob(ma,na,"onErrorLog",d),c=!0);c||Ob(ma,na,"onErrorLog",d)}});var Pb={invalidWebRTCFunctionName:"Invalid WebRTC function name"},Qb={RETRY:0,GET_NEW_TOKEN:1,REPORT_ERROR:2},Rb=a(),Sb=Object.create(null),Tb=function(a,d,e){var f=RegExp.prototype.test.bind(/^([a-z])=(.*)/),g=/^ssrc:(\d*) ([\w_]*):(.*)/,h=/^ssrc-group:SIM (\d*)/;d.split(/(\r\n|\r|\n)/).filter(f).forEach(function(d){var f=d[0],i=d.slice(2);if("a"===f){if(g.test(i)){var j=i.match(g),k=j[1];void 0===a.ssrcMap[k]&&(a.ssrcMap[k]={}),a.ssrcMap[k][j[2]]=j[3],a.ssrcMap[k].localStartTime=b(),a.ssrcMap[k].syncedStartTime=c(),a.ssrcMap[k].streamType=e}h.test(i)&&(void 0===a.ssrcMap.ssrcGroup&&(a.ssrcMap.ssrcGroup={},a.ssrcMap.ssrcGroup[e]={}),a.ssrcMap.ssrcGroup[e].simulcastGroup=i.match(/\d+/g))}})},Ub=function(a,b){return a.ssrcMap[b]},Vb=function(a){return a.ssrcMap},Wb=function(a,b,c,d,e,f){if(!e.localDescription||!e.remoteDescription)return!1;var g=e.localDescription.sdp,h=e.remoteDescription.sdp;if(!g||!h||g===d.localSDP&&h===d.remoteSDP)return!1;if(Tb(d,g,ub.outbound),Tb(d,h,ub.inbound),Ga){var i={sdp:{}};i.sdp.localSDP=g!==d.localSDP?g:-1,i.sdp.remoteSDP=h!==d.remoteSDP?h:-1,Zb(a,b,c,i,d.pcHash,f)}return d.localSDP=g,d.remoteSDP=h,!0},Xb=function(a,b,d,e,f,g,h){if(!a)return void console.error("sendEvent: Invalid eventType ");var i=c(),j={version:da,apiTS:i,action:a,localID:encodeURIComponent(na),remoteID:b?encodeURIComponent(b):null,conferenceID:encodeURIComponent(d),timeShift:0,appID:ma,ucID:e,pcID:g,deviceID:pa,value:f};return null===d?void Ob(ma,na,"log",{msg:"conferenceID is null in sendEvent for "+a}):void S(kb.callStatsEvent,j,h)},Yb=function(a,b,d,e){if(!a)return void console.error("sendEvent: Invalid eventType ");var f=c(),g={version:da,channel:kb.preCallTest,timestamp:f,apiTS:f,action:a,eventType:a,localID:encodeURIComponent(na),remoteID:encodeURIComponent(na),conferenceID:encodeURIComponent(b),timeShift:0,appID:ma,ucID:d,deviceID:pa,token:Ua.authToken};return a===lb.results&&(g.results=e,null==b)?void pd(kb.preCallTest,g):(a===lb.associate&&(g.ids=e),void(d&&!cb?S(kb.preCallTest,g):(g.clockUnsynced=cb,Oa.cacheEvent({channel:kb.preCallTest,data:g,callback:null}))))},Zb=function(a,b,d,e,f,g){var h=c(),i={version:da,appID:ma,conferenceID:encodeURIComponent(b),ucID:d,apiTS:h,localID:encodeURIComponent(na),remoteID:encodeURIComponent(a),pcID:f,deviceID:pa,sdpPayload:e,action:kb.sdpSubmission};Ua.authToken&&d&&!cb?(i.token=Ua.authToken,S(kb.sdpSubmission,i,g)):(i.clockUnsynced=cb,Oa.cacheEvent({channel:kb.sdpSubmission,data:i,callback:g}),Ua.authToken||Ua.sendAuthenticationRequest(ma,na))},$b=function(a,b,c,d,e,f,g){sc(a,function(a){b.localCandidates=a.localCandidates,b.remoteCandidates=a.remoteCandidates,b.iceCandidatePairs=a.iceCandidatePairs,b.activeIceCandidatePair=Nc(b.iceCandidatePairs),g.currPair=b.activeIceCandidatePair,Xb(jb.fabricStateChange,e,c,d,g,f)})},_b=function(a,b,c){var d={connectedDevices:la},e=ab[a]?ab[a].ucID:null;Xb(jb.connectedDevices,b,a,e,d,c)},ac=function(a){var b={ucID:ab[a].ucID,endpoint:Ya,magicKey:Rb};Xb(jb.refreshPresence,null,a,ab[a].ucID,b,null)},bc=function(a,b){var c={};return c.status=a,b&&(c.message=b),c},cc=function(a,b){var c,d,e,f=0;if(!a)return f;for(c=0,e=a.length;c<e;c++)d=a.charCodeAt(c),f=(f<<5)-f+d,f|=0;return b&&b(f),f},dc=function(a,c,d,e,f,g){if(!a||!d||!c)return console.error("initialize: Argument missing/invalid"),bc(mb.failure,"initialize: Argument missing/invalid");if(e&&"function"!=typeof e)return console.error("initialize: Argument missing/invalid"),bc(mb.failure,"initialize: Argument missing/invalid");if(f&&"function"!=typeof f)return console.error("initialize: Argument missing/invalid"),bc(mb.failure,"initialize: Argument missing/invalid");if(Ua.setAuthType(Sa.jwt),"function"!=typeof c){if(Ua.setAuthType(Sa.appSecret),!(window.crypto&&(window.crypto.subtle||window.crypto.webkitSubtle)||window.msCrypto&&window.msCrypto.subtle||window.csioReactNative))return console.error("Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API"),e&&e(nb.tokenGenerationError,"Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API"),bc(mb.failure,"Browser does not support Web Cryptography API. App secret based authentication requires Web Cryptography API");c=Ua.appSecretTokenGenerator(c)}if("string"==typeof a&&(a=parseInt(a,10)),ma=a,isNaN(ma))return bc(mb.failure,"Invalid Credentials");if("object"==typeof d?(na=d.aliasName,oa=d):na=d,Ca.initializeSinceCreate=b()-Ca.create,Ob(ma,na,"log",{msg:"callstats initialize in progress"}),g&&(g.disableBeforeUnloadHandler===!0&&(qa=!0),null!==g.applicationVersion&&void 0!==g.applicationVersion&&(Ya.appVer=uc(g.applicationVersion,30)),g.disablePrecalltest===!0&&(ra=!0)),Ua.tokenGenerator=c,Jb("csio_auth_data"))try{var h=JSON.parse(Jb("csio_auth_data"));Ua._isTokenValid(h,ma,na)&&(e&&e(nb.success,"SDK authentication successful."),Ua.setupAuthToken(h),hc(),od._isChannelReady()||od._setupWebSocketConnection(e))}catch(a){console.log("initialize: Error",a)}l(),f&&(Da.stats=f);try{Ua.sendAuthenticationRequest(ma,na,e)}catch(a){console.log("initialize: Error",a)}return bc(mb.success)},ec=function(){Ca.sent||(Ca.remoteofferSinceCreate&&Ca.config&&Ca.senderConfig||Ca.errorSinceCreate)&&(console.log("Send generic event for timing"),Ob(ma,na,"timing",Ca),Ca.sent=!0)},fc=function(a,b){"function"==typeof b&&Da.hasOwnProperty(a)&&(Da[a]=b)},gc=function(a){Ob(ma,na,"log",{msg:"precalltest finished "+va}),va+="(finished)",Da.preCallTest&&Da.preCallTest(a);try{Ba.push(a.id);var b=null,c=null;for(var d in ab)if(ab.hasOwnProperty(d)){b=d,ab[d].ucID&&(c=ab[d].ucID);break}Yb(lb.results,b,c,a)}catch(a){wa("send results",a)}},hc=function(){var a=ha+ma,b={Authorization:"Bearer "+Ua.authToken},c=Ja,d=function(a,b){200!==a.status&&setTimeout(function(){f()},100),Ca.config=b,ec();var c=JSON.parse(a.response);if(console.log("internal config:",c),c.submissionInterval&&(Fa=parseInt(c.submissionInterval,10),ja.setSubmissionInterval(Fa)),c.adaptiveStats&&ja.setReportingMode(c.adaptiveStats),c.collectSDP&&(Ga=c.collectSDP),c.qmodelThresholdsAPI){var d=c.qmodelThresholdsAPI;id("eModelThreshold",d,Eb),id("throughputThreshold",d,Ab),id("fractionalLossThreshold",d,Db),id("rttThreshold",d,Cb),id("currOverPrevFrameRateThreshold",d,Bb)}},e=function(a){200!==a.status&&setTimeout(function(){g()},100);var b=JSON.parse(a.response),c=function(a,b){var c={};return b&&(c={peerConnection:null,media:null}),a.peerConnection&&(c.peerConnection=a.peerConnection),a.media&&(c.media=a.media),a.sender&&(c.sender=a.sender),a.confidence&&(c.confidence=a.confidence),c};if(Da.defaultConfig&&b.default){var d=c(b.default,!0);d!=={}&&Da.defaultConfig(d)}if(Da.recommendedConfig&&b.recommended){var e=c(b.recommended,!1);e!=={}&&Da.recommendedConfig(e)}},f=function(){Mb(a+"/configurations/internal",b,c,d,f)},g=function(){Mb(a+"/configurations",b,c,e,g)};f(),g()},ic=function(a){return function(b){return b.pc===a||(!(!a.callstatsID||b.pcHash!==a.callstatsID)||void 0)}},jc=function(a,b){var c=null,d=null;return ab[a]&&ab[a].participants&&(d=ab[a].participants.filter(ic(b))),c=d&&d.length>0?d[0]:null},kc=function(a,b){var c=null,d=null;return c=jc(a,b),c&&(d=c.pcHash),d},lc=function(a){var b=null,c=null,d=null;for(b in ab)if(ab.hasOwnProperty(b)&&(d=jc(b,a))){c={fabric:d,conferenceID:b};break}return c},mc=function(a,b){var c=0;if(a&&ab[b].participants)for(c=0;c<ab[b].participants.length;c++)if(ab[b].participants[c].pcHash===a.pcHash){ab[b].participants.splice(c,1);break}},nc=function(a){if(a){var b=[],c=0;if(a&&a.result)b=a.result();else if(a&&a.forEach)a.forEach(function(a){b.push(a)});else for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}},oc=function(a){var b,c=null,d=null,e=null,f=[],g=[],h=[],i=0;if(c=nc(a),!c)return{localCandidates:f,remoteCandidates:g};for(i=0;i<c.length;++i)if(d=E(c[i]),e=B(d),e.localCandidate)f.push(e.localCandidate);else if(e.remoteCandidate)g.push(e.remoteCandidate);else if(e.Transport){if("transport"===e.Transport.type){b=e.Transport.selectedCandidatePairId;continue}h.push(e.Transport)}else e.candidatePair&&h.push(e.candidatePair);if(b)for(i=0;i<h.length;i++)h[i].id===b&&(h[i].googActiveConnection="true");return{localCandidates:f,remoteCandidates:g,iceCandidatePairs:h}},pc=function(a){function b(b){var c={};c=oc(b),a(c)}return b},qc=function(a){var b=null;return a&&(b=a.message+" : "+a.stack),b},rc=function(a,b,c,d,e,f){var g=Aa.codebase,h=Aa.name;if(g===Fb.firefox)if(La)try{a.getStats().then(c(b,d,e,f,a)).catch(function(h){La=!1,Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(h)}),a.getStats(null,c(b,d,e,f,a))})}catch(h){La=!1,Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(h)}),a.getStats(null,c(b,d,e,f,a))}else a.getStats(null,c(b,d,e,f,a),function(a){console.log("getstats error ",a)});else if("Safari"===h)a.getStats().then(c(b,d,e,f,a)).catch(function(a){Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(a)})});else if(g===Fb.chrome)if(window&&window.csioReactNative)a.getStats(null,c(b,d,e,f,a),function(a){Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(a)})});else if(La)try{a.getStats().then(c(b,d,e,f,a)).catch(function(h){La=!1,Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(h)}),a.getStats(c(b,d,e,f,a))})}catch(h){La=!1,Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(h)}),a.getStats(c(b,d,e,f,a))}else a.getStats(c(b,d,e,f,a));else g===Fb.edge&&a.getStats().then(c(b,d,e,f,a)).catch(function(a){Ob(ma,d,"log",{msg:"### "+g+" getStats reports error "+qc(a)})})},sc=function(a,b){try{rc(a,b,pc)}catch(a){console.log("csioGetStats: Error",a)}},tc=function(a,b,c,d){if(c||(c=ia),!a||!b)return console.error("sendFabricEvent: Arguments missing/Invalid"),bc(mb.failure,"sendFabricEvent: Arguments missing/Invalid");if(!ma||!na||!ab[c])return console.error("sendFabricEvent: SDK is not initialized or no Fabrics added."),bc(mb.failure,"sendFabricEvent: SDK is not initialized or no Fabrics added.");if(b===ib.fabricSetupFailed)return console.error("sendFabricEvent: Unsupported fabricEvent fabricSetupFailed"),bc(mb.failure,"sendFabricEvent: Unsupported fabricEvent fabricSetupFailed");if(!p(a))return console.error("sendFabricEvent: Invalid PeerConnection object passed"),bc(mb.failure,"sendFabricEvent: Invalid PeerConnection object passed");if(!ib.hasOwnProperty(b)&&!jb.hasOwnProperty(b))return console.error("sendFabricEvent: Invalid fabricEvents value: ",b),bc(mb.failure,"sendFabricEvent: Invalid fabricEvents value: "+b);var e={},f=null,g=ab[c],h=null;if(void 0===g)return console.error("sendFabricEvent: Conference ID not found!"),bc(mb.failure,"sendFabricEvent: Conference ID not found!");if(h=jc(c,a),null===h)return console.error("sendFabricEvent: fabricData is null"),bc(mb.failure,"sendFabricEvent: fabricData is null");if(f=h.remoteUserID,b===ib.activeDeviceList){if(!d||!d.deviceList)return console.error("sendFabricEvent: Arguments missing/Invalid"),bc(mb.failure,"sendFabricEvent: Arguments missing/Invalid");if(!(d.deviceList instanceof Array))return console.error("sendFabricEvent: DeviceList Invalid"),bc(mb.failure,"sendFabricEvent: DeviceList Invalid");e={magicKey:Rb,endpoint:Ya,activeDevicelist:d.deviceList}}if(b!==ib.screenShareStart&&b!==ib.screenShareStop||(e={magicKey:Rb,endpoint:Ya},d&&(e.ssrc=d.ssrc)),Xb(b,f,c,g.ucID,e,h.pcHash,h.pcCallback),b===ib.fabricTerminated){if(ab[c].participants){h&&(h.statsInterval=J(h.statsInterval),mc(h,c));var i=N(c);i.conferenceFinished&&O(c,i.ucID)}}else b===ib.fabricHold?(h.statsInterval=J(h.statsInterval),h.onHold=!0):b===ib.fabricResume&&(h.onHold=!1,Qc(h,a,c,f));return bc(mb.success)},uc=function(a,b){return a&&"string"==typeof a?(a.length>b&&(a=a.substring(0,b)),a):null},vc=function(a){return a&&"string"==typeof a?a=uc(a,Ea):a&&"object"==typeof a&&a.message&&(a.message=uc(a.message,Ea)),a},wc=function(a,b,c){return b?b:a&&a[c]?a[c].sdp:-1},xc=function(c,d,e,f,g,h){if(d||(d=ia),void 0===c||!e)return console.error("reportError: Arguments missing/invalid"),bc(mb.error,"reportError: Arguments missing/invalid");if(!ma||!na)return console.error("reportError: SDK is not initialized"),bc(mb.error,"reportError: SDK is not initialized");if(!yb.hasOwnProperty(e))return console.error("reportError: Invalid webRTC functionName value: %o",e),bc(mb.error,"reportError: Invalid webRTC functionName value: "+e);void 0===f&&console.warn("reportError: Missing dom error parameter");var i,j,k,l=null,m=b(),n=ab[d],o=null,q=m,r=null,s=null,t=null,u=null;if(t=R(d),j=A(e),e!==yb.getUserMedia&&(u=a()),f)if(window.DOMException&&f instanceof window.DOMException)f={message:f.message,name:f.name};else if("object"==typeof f){var v={};f.message&&(v.message=f.message),f.name&&(v.name=f.name),f.constraintName&&(v.constraintName=f.constraintName),f.stack&&(v.stack=f.stack),f=v}if(f=vc(f),p(c)){n&&(t=n.ucID),o=jc(d,c),o?(i=o.remoteUserID,q=o.startTime,r=o.pcState,s=o.pc.iceConnectionState,u=o.pcHash,k=o.pcCallback):i=na;var w=m-q;if(l={failureDelay:w,reason:j,domError:f,fabricState:r,iceConnectionState:s,function:e,magicKey:Rb,endpoint:Ya},e===yb.applicationLog||e===yb.applicationError?Xb(ib.applicationErrorLog,i,d,t,l,u,k):(Xb(ib.fabricSetupFailed,i,d,t,l,u,k),Ca.errorSinceCreate=b()-Ca.create,ec()),g||h||c&&c.localDescription||c&&c.remoteDescription){var x={sdp:{}};x.sdp.localSDP=wc(c,g,"localDescription"),x.sdp.remoteSDP=wc(c,h,"remoteDescription"),Zb(i,d,t,x,u)}}else null===Rb&&(Rb=a()),i=na,l={failureDelay:0,reason:j,domError:f,function:e,magicKey:Rb,endpoint:Ya},e===yb.applicationLog||e===yb.applicationError?Xb(ib.applicationErrorLog,i,d,t,l,null,null):Xb(ib.fabricSetupFailed,i,d,t,l,u,null);return bc(mb.success)},yc=function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b[b.length]=d:d>127&&d<2048?(b[b.length]=d>>6|192,b[b.length]=63&d|128):(b[b.length]=d>>12|224,b[b.length]=d>>6&63|128,b[b.length]=63&d|128)}return new Uint8Array(b).buffer},zc=function(a){for(var b,c=new DataView(a),d="",e=0;e<c.byteLength;e++)b=c.getUint8(e).toString(16),b.length<2&&(b="0"+b),d+=b;return d},Ac=function(a,b){var c={name:"SHA-256"};if(window.crypto){var d=window.crypto.subtle||window.crypto.webkitSubtle;if(!d)return void cc(a,b);d.digest(c,yc(a)).then(function(a){b(zc(a))}).catch(function(){cc(a,b)})}else if(window.msCrypto){if(!window.msCrypto.subtle)return void cc(a,b);var e=window.msCrypto.subtle.digest(c,yc(a));e.oncomplete=function(a){a.target&&b(zc(a.target.result))},e.onerror=function(){cc(a,b)}}else cc(a,b)},Bc=function(a,b,c){var d;if(!b||!a)return console.error("sendUserFeedback: Arguments missing/Invalid"),bc(mb.error,"sendUserFeedback: Arguments missing/Invalid");if("object"!=typeof b)return console.error("sendUserFeedback: Invalid feedback object."),bc(mb.error,"sendUserFeedback: Invalid feedback object.");if(0===Object.keys(b).length)return console.error("sendUserFeedback: Feedback data object must not be empty."),bc(mb.error,"sendUserFeedback: Feedback data object must not be empty.");var e=ab[a],f=null;void 0!==e&&void 0!==e.ucID&&(f=e.ucID);var g=null;if(g=null===Rb?db:Rb,null===f&&(f=R(a)),null===f)return console.error("sendUserFeedback: ucID unavailable"),bc(mb.error,"sendUserFeedback: ucID unavailable");d="object"==typeof b.userID?b.userID.aliasName:b.userID,b&&b.overall<=0&&(b.overall=null);var h={conferenceID:encodeURIComponent(a),magicKey:g,appID:ma,version:da,ucID:f,remoteID:encodeURIComponent(d),userID:encodeURIComponent(d),userQoe:{overall:b.overall}};return b.video&&(h.userQoe.video=b.video),b.audio&&(h.userQoe.audio=b.audio),b.screen&&(h.userQoe.screen=b.screen),b.comment&&(h.userQoe.comment=b.comment),Ua.authToken&&!cb?(h.token=Ua.authToken,Ib("feedback",JSON.stringify(h)),S(kb.userFeedback,h,c)):(h.clockUnsynced=cb,Oa.cacheEvent({channel:kb.userFeedback,data:h,callback:c}),Ua.sendAuthenticationRequest(ma,d)),bc(mb.success)},Cc=function(a){return a?"function"!=typeof a?(console.error("attachWifiStatsHandler: Arguments Invalid"),bc(mb.error,"attachWifiStatsHandler: Arguments Invalid")):(Z=a,void k()):(console.error("attachWifiStatsHandler: Arguments missing"),bc(mb.error,"attachWifiStatsHandler: Arguments missing"))},Dc=function(a,b,c,d,e,f){var g=null;if(g="object"==typeof b?b.aliasName:b,c||(c=ia),!(a&&d&&e&&g))return console.error("associateMstWithUserID: Arguments missing"),bc(mb.error,"associateMstWithUserID: Arguments missing");if(!p(a))return console.error("associateMstWithUserID: Invalid PeerConnection object passed"),bc(mb.error,"associateMstWithUserID: Invalid PeerConnection object passed");var h=ab[c];if(void 0===h)return console.error("associateMstWithUserID: conferenceID doesn't exist"),bc(mb.error,"associateMstWithUserID: conferenceID doesn't exist");var i=null;if(i=jc(c,a),null===i)return console.error("associateMstWithUserID: Unknown pcObject passed"),bc(mb.error,"associateMstWithUserID: Unknown pcObject passed");var j=Ub(i,d);return void 0===j&&(i.ssrcMap[d]={},j=Ub(i,d)),j.remoteUserID=g,j.ssrc=d,j.associatedVideoTag=f,j.usageLabel=e,f&&g!==na&&o(c,f,a,d),bc(mb.success)},Ec=function(a){var b=ab[ia];if(b){var c=ab[ia].participants;if(c)for(var d=0;d<c.length;d++)c[d].conferenceID=a}},Fc=function(a){Oa.updateConferenceId(encodeURIComponent(a))},Gc=function(a,b){var c=lc(b);c&&Oa.updateRemoteUserID(a,c.fabric.pcHash)},Hc=function(a,b){var c=null;c=lc(b),c&&(c.fabric.remoteUserID=a)},Ic=function(){Oa.sendCachedUserJoinedEvents(Ua),Oa.sendCachedEvents(Ua,cb)},Jc=function(a,b){return a?(a.conferenceID&&(Ec(a.conferenceID),ab[a.conferenceID]=ab[ia],Fc(a.conferenceID),Ic()),a.remoteUserID&&b&&(Gc(a.remoteUserID,b),Hc(a.remoteUserID,b),Ic()),bc(mb.success)):(console.error("setIdentifiers: Arguments missing/Invalid"),bc(mb.error,"_setIdentifiers: Arguments missing/Invalid"))},Kc=function(a){return window&&!window.csioproxy?(console.error("setCallstatsURLs: cannot be called if window.csioproxy is false"),bc(mb.error,"setCallstatsURLs: cannot be called if window.csioproxy is false")):a?(a.collectorURL&&(ba=a.collectorURL),a.authServiceURL&&(ca=a.authServiceURL),a.csioInternalAPIURL&&(ga=a.csioInternalAPIURL),a.wsURL&&(ea=a.wsURL),kd(),Q(),W(),bc(mb.success)):(console.error("setCallstatsURLs: Arguments missing/Invalid"),bc(mb.error,"setCallstatsURLs: Arguments missing/Invalid"))},Lc=function(c,d,e,f,g,h){var i,k,l=null,m=pb.peer,n=qb.sendrecv,o={authStatus:!!Ua.tokenData,clockSync:!cb,msg:"addNewFabric called",eventType:"warn",pageURL:window.location.href,conferenceID:f,version:da};if(W(),Ob(ma,na,"stateMachine",o),l=d&&"object"==typeof d?d.aliasName:d,f||(f=ia),!c||!e)return console.error("addNewFabric: Arguments missing/Invalid"),bc(mb.error,"addNewFabric: Arguments missing/Invalid");if(!ma||!na)return console.error("addNewFabric: SDK not initialized."),bc(mb.error,"addNewFabric: SDK not initialized");if(!p(c))return console.error("addNewFabric: Invalid PeerConnection object passed"),bc(mb.error,"addNewFabric: Invalid PeerConnection object passed");if(!rb.hasOwnProperty(e)||e instanceof Function)return console.error("addNewFabric: Invalid fabricUsage value"),bc(mb.error,"addNewFabric: Invalid fabricUsage value");if(h&&"function"==typeof h&&(i=h),g&&"function"==typeof g&&(i=g),g&&"function"!=typeof g){if(g.remoteEndpointType){if(!pb.hasOwnProperty(g.remoteEndpointType))return console.error("addNewFabric: Invalid remoteEndpointType value"),bc(mb.error,"addNewFabric: Invalid remoteEndpointType value");m=g.remoteEndpointType}if(g.fabricTransmissionDirection){if(!qb.hasOwnProperty(g.fabricTransmissionDirection))return console.error("addNewFabric: Invalid fabricTransmissionDirection value"),bc(mb.error,"addNewFabric: Invalid fabricTransmissionDirection value");n=g.fabricTransmissionDirection}}var q=b();Ca.addnewfabricSinceCreate=q-Ca.create,ec(),null===Rb&&(Rb=a());var r=null,s=!1;if(!L(f)){var t=G(Rb);Xb(jb.userJoined,null,f,null,t,null,null),s=!0,o={authStatus:!!Ua.tokenData,clockSync:!cb,msg:"userJoined sent",pageURL:window.location.href,eventType:"warn",conferenceID:f,version:da},Ob(ma,na,"stateMachine",o)}if(H(f,r,s),!jc(f,c)){if(c){new aa(c,_c,Zc,Pc,Yc)}k=a();var u={pc:c,remoteUserID:l,fabricUsage:e,magicKey:Rb,startTime:q,pcCallback:h,pcState:xb.initializing,fabricSetupSent:!1,iceCandidates:[],iceConnectionState:c.iceConnectionState,latestEventSent:q,pcHash:k,localSDP:-1,remoteSDP:-1,statsInterval:null,intervalAdaptionPhase:!0,gatheringIceCandidatesDelay:0,connectivityIceStatusDelay:0,numNegotiationNeededCalls:0,currentActivePhaseIndex:0,onHold:!1,ssrcMap:{},conferenceID:f,remoteEndpointType:m,fabricTransmissionDirection:n};Za&&(Xb(kb.senderConfiguration,d,f,null,$a,u.pcHash),Za=!1),"function"!=typeof c||c.callstatsID||(c.callstatsID=k),"connected"!==c.iceConnectionState&&"completed"!==c.iceConnectionState||(u.pcState=xb.established),M(f,u),u.pcState===xb.established&&(bd(c,jb.autoFabricSetup,f),Qc(u,c,f));var v=function(a){var b=0;return Object.keys(a).forEach(function(a){a&&a.mediaType&&(b+="audio"===a.mediaType?1:0)}),0<b},w=function(){return!!u.ssrcMap&&v(u.ssrcMap)},x=function(){return!(!u.ssrcMap||n!==qb.sendonly)&&v(u.ssrcMap)},y=function(){return!!u.ssrcMap&&void Object.keys(u.ssrcMap).forEach(function(a){Ma.push(a)})},z=null;if(e===rb.multiplex&&w()?z={mediaType:"audio",ssrc:null,disruptionType:vb.noAudioInMultiplexFabric}:e===rb.audio&&x()?z={mediaType:"audio",ssrc:null,disruptionType:vb.noOutboundAudioOnlyFabric}:e===rb.audio&&n===qb.receiveonly&&y(),z){var A=ab[f]?ab[f].ucID:null;Xb(jb.oneWayMedia,l,f,A,z,u.pcHash)}}if(!k){var B=jc(f,c);k=B.pcHash}if(j(f,l,k),ya)try{var C=Ba;Ba=[];var D=null;if(D=ya.getId(),D&&C.push(D),C.length>0){var E=ab[f].ucID;Yb(lb.associate,f,E,C)}}catch(a){wa("send associate",a)}return bc(mb.success)},Mc=function(a,b,c,d){if(!(a&&c&&d&&b))return console.error("reportUserIDChange: Arguments missing/Invalid"),bc(mb.error,"reportUserIDChange: Arguments missing/Invalid");if(!ma||!na)return console.error("reportUserIDChange: SDK not initialized."),bc(mb.error,"reportUserIDChange: SDK not initialized");if(""===c||""===b)return console.error("reportUserIDChange: id or  conferenceID MUST not be empty"),bc(mb.error,"reportUserIDChange: id or  conferenceID MUST not be empty");if(!p(a))return console.error("reportUserIDChange: Invalid PeerConnection object passed"),bc(mb.error,"reportUserIDChange: Invalid PeerConnection object passed");var e,f=null,g=ab[b];if(void 0===g)return console.error("reportUserIDChange: Conference ID not found!"),bc(mb.error,"reportUserIDChange: Conference ID not found!");var h=null;if(void 0===g.ucID)return console.error("reportUserIDChange: addNewFabric was not called"),Ob(ma,na,"log",{msg:"### reportUserIDChange: addNewFabric was not called"}),bc(mb.error,"reportUserIDChange: addNewFabric was not called");if(h=g.ucID,f=jc(b,a),null===f)return console.error("reportUserIDChange: Invalid pcObject passed as argument"),bc(mb.error,"reportUserIDChange: Invalid pcObject passed as argument");var i={id:c,idType:d};return Xb(ib.userIDChangedEvent,e,b,h,i,null,f.pcCallback),bc(mb.success)},Nc=function(a){var b=null;if(a&&a.length>0){var c=a.filter(function(a){return"true"===a.selected||"true"===a.googActiveConnection||a.selected===!0||a.googActiveConnection===!0});c.length>0&&(b=c[0])}return b},Oc=function(a){var c=b(),d=function(){Ca.senderConfig=-1,Ca.senderExists=!1,ec()},e=function(a){var d=JSON.parse(a.response);console.log("Sender config response:",a.status,d);var e;d.recommended&&d.recommended.sender&&(e=d.recommended.sender,console.log("ConfigService, recommended SENDER info:",e)),e&&($a=e,Za=!0),Ca.senderConfig=b()-c,Ca.senderExists=!!e,ec()},f=function(a){_a=a;var b=ha+ma+"/configurations",c={Authorization:"Bearer "+Ua.authToken},d={app_id:ma,local_id:na,rtc_rtp_parameters:a},f=JSON.stringify(d);Nb(b,f,e,c)},g=function(){var a={encodings:[{maxBitrate:0}]};f(a)};if(Object.keys(ab).length>1)return console.warn("Multiple PCs found, skipping"),void d();if(!a.getSenders||"function"!=typeof a.getSenders)return console.warn("Get senders error"),void g();var h,i=a.getSenders();for(var j in i){var k=i[j];if("object"!=typeof k||!k.track||"object"!=typeof k.track||!k.track.kind)return console.warn("Access senders error"),void d();if("video"===k.track.kind){if(h)return console.warn("Multiple video sender, skipping"),void d();h=k}}if(!h)return console.warn("No video sender found"),void d();if(!h.getParameters||"function"!=typeof h.getParameters)return console.warn("Sender getParameters error"),void g();var l=h.getParameters();return"object"!=typeof l?void d():("encodings"in l||(l.encodings=[]),0===l.encodings.length&&l.encodings.push({maxBitrate:0}),void f(l))},Pc=function(a,c){if(a){var d,e=null;if(void 0!==c){var f=c.signalingState;if(e=lc(c),e&&e.fabric){d=e.fabric.signalingState,e.fabric.signalingState=f;var g=e.conferenceID,h=e.fabric,i=h.remoteUserID,j=ab[g].ucID,k={changedState:Gb.signalingState,prevState:d,newState:f};$b(c,h,g,j,i,h.pcHash,k),"closed"===f&&tc(c,ib.fabricTerminated,e.conferenceID),"have-local-offer"!==f&&"have-local-pranswer"!==f&&"stable"!==f||e.sentSenderConfigRequest||(console.log(f,".. requesting sender config.",e.sentSenderConfigRequest),e.sentSenderConfigRequest=!0,Oc(c))}if("closed"===f&&ya)try{ya.callFinished()}catch(a){wa("callFinished",a),ya.crashDisconnect()}if("have-remote-offer"===f||"stable"===f){if(Ca.remoteofferSinceCreate=b()-Ca.create,ec(),ya)try{ya.callStarts()}catch(a){wa("callStarts",a),ya.crashDisconnect()}Ob(ma,na,"log",{msg:"precalltest told to stop "+va}),va+="(stopped)"}}}},Qc=function(a,c,d){if(!a.onHold){var e=c,f=d;null===a.statsInterval&&(a.statsPollingStart=b(),ad(e,f),a.statsInterval=setInterval(function(){ad(e,f)},ua))}},Rc=function(a,b,c,d,e,f){f.localCandidates=b.localCandidates,f.remoteCandidates=b.remoteCandidates,f.iceCandidatePairs=b.iceCandidatePairs,Xb(jb.iceFailed,c,d,e,f,b.pcHash,b.pcCallback)},Sc=function(a,b,c,d){var e=b.iceConnectionState,f=b.remoteUserID,g=ab[c],h={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState,currPair:b.activeIceCandidatePair,failureDelay:d};b.pcState=xb.failed,"checking"===e?Rc(a,b,f,c,g.ucID,h):"completed"===e||"connected"===e?Xb(jb.fabricDropped,f,c,g.ucID,h,b.pcHash,b.pcCallback):"disconnected"===e&&b.established?Xb(jb.fabricDropped,f,c,g.ucID,h,b.pcHash,b.pcCallback):"disconnected"===e&&Rc(a,b,f,c,g.ucID,h)},Tc=function(a,c,d,e){var f=c.iceConnectionState,g=c.remoteUserID,h=ab[d],i=b(),j={prevIceConnectionState:f,currIceConnectionState:a.iceConnectionState,prevPair:c.activeIceCandidatePair},k=c.pcState===xb.disrupted,l="completed"===a.iceConnectionState;c.connectivityIceStatusDelay=e,c.established=!0,sc(a,function(a){if(c.localCandidates=a.localCandidates,c.remoteCandidates=a.remoteCandidates,c.iceCandidatePairs=a.iceCandidatePairs,c.activeIceCandidatePair=Nc(c.iceCandidatePairs),j.currPair=c.activeIceCandidatePair,j.disruptionDelay=i-c.disruptedTS,k)Xb(jb.iceDisruptionEnd,g,d,h.ucID,j,c.pcHash);else if(l){var b={};b.iceCandidatePairs=a.iceCandidatePairs,Xb(jb.iceCompleted,g,d,h.ucID,b,c.pcHash)}}),bd(c.pc,jb.autoFabricSetup,d),c.pcState=xb.established,Qc(c,a,d,g)},Uc=function(a,c,d){var e=c.iceConnectionState,f=c.remoteUserID,g=ab[d],h=b(),i={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState,prevIceConnectionStateTs:c.iceConnectionStateTS,currPair:c.activeIceCandidatePair};c.startTime=h,"connected"===e||"completed"===e?(c.pcState=xb.disrupted,c.disruptedTS=h,Xb(jb.iceDisruptionStart,f,d,g.ucID,i,c.pcHash,c.pcCallback),c.pcCallback&&c.pcCallback(nb.appConnectivityError,"Connectivity check for PC object to "+f+" failed.")):"checking"===e&&(c.pcState=xb.checkingDisrupted,c.disruptedTS=h,Xb(jb.iceConnectionDisruptionStart,f,d,g.ucID,i,c.pcHash,c.pcCallback),c.pcCallback&&c.pcCallback(nb.appConnectivityError,"Connectivity check for PC object to "+f+" failed."))},Vc=function(a,b,c,d){var e=b.iceConnectionState,f=b.remoteUserID,g=ab[c],h={prevIceConnectionState:e,currIceConnectionState:a.iceConnectionState};"new"===e||"checking"===e?(h.failureDelay=d,Xb(jb.iceAborted,f,c,g.ucID,h,b.pcHash,b.pcCallback)):(h.currPair=b.activeIceCandidatePair,
Xb(jb.iceTerminated,f,c,g.ucID,h,b.pcHash,b.pcCallback))},Wc=function(a,b,c){var d=b.iceConnectionState,e=b.remoteUserID,f=ab[c],g={prevIceConnectionState:d,currIceConnectionState:a.iceConnectionState,prevPair:b.activeIceCandidatePair};"new"!==d&&(b.established=!1,Xb(jb.iceRestarted,e,c,f.ucID,g,b.pcHash,b.pcCallback))},Xc=function(a,c,d,e){var f=c.iceConnectionState,g=c.remoteUserID,h=ab[d],i=b(),j={prevIceConnectionState:f,currIceConnectionState:a.iceConnectionState};c.gatheringIceCandidatesDelay=e,"disconnected"===f&&c.pcState===xb.checkingDisrupted&&(j.disruptionDelay=i-c.disruptedTS,Xb(jb.iceConnectionDisruptionEnd,g,d,h.ucID,j,c.pcHash,c.pcCallback))},Yc=function(a,b){if(a&&void 0!==b){var c=null;c=lc(b),c&&c.fabric&&c.fabric.numNegotiationNeededCalls++}},Zc=function(a,c){if(a&&void 0!==c){var d,e,f,g,h,i=null,j=null;if(j=lc(c),j&&j.fabric){i=j.fabric,d=j.conferenceID,e=b(),f=e-i.startTime,g=i.iceConnectionState,h=i.iceGatheringState;var k=i.remoteUserID,l=ab[d].ucID,m={changedState:Gb.iceConnectionState,prevState:g,newState:c.iceConnectionState};if($b(c,i,d,l,k,i.pcHash,m),h!==c.iceGatheringState){var n={changedState:Gb.iceGatheringState,prevState:h,newState:c.iceGatheringState};$b(c,i,d,l,k,i.pcHash,n)}"complete"===c.iceGatheringState&&"checking"===c.iceConnectionState&&Xc(c,i,d,f),"connected"===c.iceConnectionState||"completed"===c.iceConnectionState?Tc(c,i,d,f):"failed"===c.iceConnectionState?Sc(c,i,d,f):"disconnected"===c.iceConnectionState?Uc(c,i,d):"closed"===c.iceConnectionState?Vc(c,i,d,f):"new"===c.iceConnectionState&&Wc(),i.iceConnectionState=c.iceConnectionState,i.iceGatheringState=c.iceGatheringState,i.iceConnectionStateTS=b()}}},$c=function(a,b){var c=lc(a);if(c&&c.fabric){var d=c.fabric,e=d.remoteUserID,f=c.conferenceID,g=ab[f].ucID;Xb(jb.iceCandidateFound,e,f,g,b,d.pcHash)}},_c=function(a,b){var c,d,e;if(void 0!==b){if(null!==a.candidate){var f=a.candidate.candidate;d=f.split(" ");var g="1"===d[1]?"rtp":"rtcp";"0"!==d[5]&&(e=d[4].indexOf(":")!==-1,c={transport:d[2],protocol:g,typePreference:d[3],address:e?"["+d[4]+"]:"+d[5]:d[4]+":"+d[5],type:d[7],media:a.candidate.sdpMid})}var h=null;h=lc(b),sc(b,function(a){h.localCandidates=a.localCandidates,h.remoteCandidates=a.remoteCandidates,h.iceCandidatePairs=a.iceCandidatePairs,h.activeIceCandidatePair=Nc(h.iceCandidatePairs)}),h&&h.fabric&&(void 0!==c&&h.fabric.iceCandidates.indexOf(c)===-1&&h.fabric.iceCandidates.push(c),c&&h.fabric.fabricSetupSent&&$c(b,c))}},ad=function(a,b){if(!ab.hasOwnProperty(b))return void console.error("ConferenceID %o doesn't exist. Can't call getStats for it.",b);if("closed"===a.signalingState)return tc(a,ib.fabricTerminated,b),!0;var c=jc(b,a);if(c.pcState!==xb.established&&c.lastFabricState===c.pcState&&"connected"!==a.iceConnectionState&&"completed"!==a.iceConnectionState)return!0;var d=ab[b].ucID;try{rc(a,c.pcCallback,z,na,d,c)}catch(a){console.log("csioGetStats: Error",a)}},bd=function(a,c,d){var e,f=null,g=ab[d],h=null,i=b();if(void 0===g&&console.error("sendAutoFabricSetupEvent: Conference ID not found!"),h=jc(d,a),null===h&&console.error("sendAutoFabricSetupEvent: fabricData is null"),!h.fabricSetupSent){f=h.remoteUserID,e=i-h.startTime;var j={setupDelay:e,iceGatheringDelay:h.gatheringIceCandidatesDelay,iceConnectivityDelay:h.connectivityIceStatusDelay,remoteEndpointType:h.remoteEndpointType,fabricTransmissionDirection:h.fabricTransmissionDirection};cb||(j.clockSyncOffset=bb.currentOffset),sc(a,function(a){j.localCandidates=a.localCandidates,j.remoteCandidates=a.remoteCandidates,j.iceCandidatePairs=a.iceCandidatePairs,h.localCandidates=a.localCandidates,h.remoteCandidates=a.remoteCandidates,h.iceCandidatePairs=a.iceCandidatePairs,h.pcState=xb.established,h.activeIceCandidatePair=Nc(h.iceCandidatePairs),h.fabricSetupSent||(Xb(c,f,d,g.ucID,j,h.pcHash,h.pcCallback),h.fabricSetupSent=!0)})}},cd=function(a,b,c){var d={},e=null,f=ab[c],g=null;void 0===f&&console.error("sendFabricTransportSwitchEvent: Conference ID not found!"),g=jc(c,a),null===g&&console.error("sendFabricTransportSwitchEvent: fabricData is null"),e=g.remoteUserID,d.prevPair=g.activeIceCandidatePair,sc(a,function(a){d.currPair=Nc(a.iceCandidatePairs),g.activeIceCandidatePair=d.currPair,d.switchDelay=null,d.relayType=g.transportData.relayType,Xb(b,e,c,f.ucID,d,g.pcHash,g.pcCallback)})},dd=function(a,b){if(a.trackStats){var c=a.trackStats.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},ed=function(a,b){if(a.codec){var c=a.codec.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},fd=function(a,b){if(a.candidatePair){var c=a.candidatePair.filter(function(a){return a.id===b});if(c.length>0)return c[0]}},gd=function(a){for(var b,c,d=a.Transport.length,e=0;e<d;e++)c=a.Transport[e],c.selectedCandidatePairId&&(b=fd(a,c.selectedCandidatePairId),b&&(a.Transport[e]=y(a.Transport[e],b)));return a},hd=function(a){for(var b,c,d,e=a.streams.length,f=0;f<e;f++)b=a.streams[f],b.data.trackId&&(c=dd(a,b.data.trackId),c&&(a.streams[f].data=y(a.streams[f].data,c))),b.data.codecId&&(d=ed(a,b.data.codecId),d&&(a.streams[f].data=y(a.streams[f].data,d)));return a},id=function(a,b,c){b.hasOwnProperty(a)&&(b[a].hasOwnProperty("video")&&(b[a].video.isGreaterBetter?(c.video.gThreshold=b[a].video.upperThreshold,c.video.rThreshold=b[a].video.lowerThreshold):(c.video.gThreshold=b[a].video.lowerThreshold,c.video.rThreshold=b[a].video.upperThreshold)),b[a].hasOwnProperty("audio")&&(b[a].audio.isGreaterBetter?(c.audio.gThreshold=b[a].audio.upperThreshold,c.audio.rThreshold=b[a].audio.lowerThreshold):(c.audio.gThreshold=b[a].audio.lowerThreshold,c.audio.rThreshold=b[a].audio.upperThreshold)))},jd=function(a,c,d){var e=[],f=null,g=null;for(var h in c)c.hasOwnProperty(h)&&e.push(encodeURIComponent(h)+"="+encodeURIComponent(c[h]));var i=e.join("&"),j=new XMLHttpRequest;j.open("POST",a),j.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f=b(),j.onload=function(){g=b();var a=g-f;d(j,a)},j.send(i)},kd=function(){Mb(ga,null,5e3,function(a){if(200===a.status)try{var b=JSON.parse(a.responseText);id("eModelThreshold",b,Eb),id("throughputThreshold",b,Ab),id("fractionalLossThreshold",b,Db),id("rttThreshold",b,Cb),id("currOverPrevFrameRateThreshold",b,Bb)}catch(a){return a}},function(){cb&&kd()})},ld=function(){var a=ba+"clockSync",c=null,d=null;Mb(a,null,5e3,function(a,e){200===a.status?(c=JSON.parse(a.response),d=b(),md(c,e,d)):cb&&setTimeout(function(){ld()},100)},function(){cb&&ld()})},md=function(a,b,c){if(cb){var d=b/2;if(d>bb.maxAllowedLatency)bb.offsetResults=[],Ob(ma,na,"log",{msg:"clockSync restarting"});else{var e=a.now+d,f=e-c;bb.offsetResults.push(f),Ob(ma,na,"log",{msg:"clockSync Info serverTime "+e+" responseRecvTs "+c+" requestExecutionTime "+b})}if(bb.offsetResults.length>=bb.syncAttempts){var g=bb.offsetResults.reduce(function(a,b){return a+b});bb.currentOffset=g/bb.offsetResults.length,Ob(ma,na,"log",{msg:"clockSync Done "+bb.currentOffset+"Length "+bb.offsetResults.length}),bb.offsetResults=[],cb=!1,Oa.sendCachedUserJoinedEvents(Ua),Oa.sendCachedEvents(Ua,cb)}else cb&&setTimeout(function(){ld()},100)}},nd=function(){var a=this,c=null,d=!1,e=!1,f={},g={initiated:"initiated",connected:"connected",closed:"closed"};this._wsConnectionState=g.closed;var h=function(a,b){try{if(window&&window.sessionStorage){var c=JSON.parse(window.sessionStorage.getItem("csio_ucid_data"));c||(c={}),c[a]||(c[a]={}),c[a].ucID=b,window.sessionStorage.setItem("csio_ucid_data",JSON.stringify(c))}}catch(a){return}f[a]=fa+ma+"/conferences/"+encodeURIComponent(a)+"/"+b+"/general"};this.getConferenceURL=function(){return f},this._setupWebSocketConnection=function(f){return a._wsConnectionState===g.initiated||a._wsConnectionState===g.connected?(Ob(ma,na,"log",{msg:"### _setupWebSocketConnection is called when already connected!"}),console.log("### _setupWebSocketConnection is called when already connected!"),void(f&&f(nb.success,"WebSocket establishment successful."))):(a._wsConnectionState=g.initiated,c=new WebSocket(ea,"echo-protocol"),c.onopen=function(){console.log("**** Successfully connected to the backend ",e,na),Ob(ma,na,"log",{msg:"Successfully connected to the backend"}),a._wsConnectionState=g.connected,d?e=!0:d=!0,Oa.sendCachedUserJoinedEvents(Ua),e&&(P(),Oa.sendCachedEvents(Ua,cb)),e=!1},c.onclose=function(){a._wsConnectionState=g.closed,console.log("**** Connection to the server closed."),Ob(ma,na,"log",{msg:"Connection to the server closed."}),K(),c&&(c=null),f&&f(nb.httpError,"Connection to the server closed.")},c.onerror=function(b){a._wsConnectionState=g.closed,Ob(ma,na,"log",{msg:"WebSocket establishment failed."}),console.log("WebSocket establishment failed.",b),f&&f(nb.wsChannelFailure,"WebSocket establishment failed.",b)},void(c.onmessage=function(a){var c,d=a.data,e=b(),g=JSON.parse(d);if("Error"===g.status)"Invalid client token."===g.reason&&(Ua.tokenData=null,Ua.authToken=null,Ua.sendAuthenticationRequest(ma,na)),f&&f(nb.csProtoError,d.reason);else if("200 OK"===g.status)if("feedback"===g.event)Kb("feedback");else if(g.event===jb.userJoined||g.event===jb.refreshPresence){var i=!1,j=null;c=decodeURIComponent(g.conferenceID);var k=function(a){return setInterval(function(){ac(a)},Ha)};ab.hasOwnProperty(c)&&(ab[c].ucID!==g.ucID&&(i=!0,h(c,g.ucID),j=g.conferenceCreationTS?g.conferenceCreationTS:g.conferenceDuration),g.event!==jb.userJoined||ab[c].refreshPresence||(ab[c].refreshPresence=k(c),X()),ab[c].ucID=g.ucID),Oa.sendCachedFeedback(),Oa.sendCachedEvents(Ua,cb,i,j,c,g.ucID)}else g.event===kb.clockSync?md(g,e):g.event===ib.fabricSetupFailed&&(c=decodeURIComponent(g.conferenceID),g.ucID&&(h(c,g.ucID),Oa.sendCachedFeedback(),Oa.sendCachedEvents(Ua,cb,!0,0,c,g.ucID)))}))},this._isChannelReady=function(){return!(!c||1!==c.readyState)},this.getWSConnectionState=function(){return c?c.readyState:-1},this.send=function(a){c.send(JSON.stringify(a))}},od=new nd,pd=function(a,b,c){if(od._isChannelReady())try{od.send(b)}catch(d){d&&"InvalidStateError"===d.name&&Oa.cacheEvent({channel:a,data:b,callback:c})}else Oa.cacheEvent({channel:a,data:b,callback:c}),od._setupWebSocketConnection()};return f(),Lb(),Y(),window&&!window.csioproxy&&(kd(),Q()),window&&window.csioChromeLegacyGetStats&&(La=!1),{version:da,initialize:dc,on:fc,fabricEvent:ib,addNewFabric:Lc,sendFabricEvent:tc,sendUserFeedback:Bc,associateMstWithUserID:Dc,attachWifiStatsHandler:Cc,csError:nb,fabricUsage:rb,qualityRating:tb,webRTCFunctions:yb,reportError:xc,reportUserIDChange:Mc,userIDType:sb,setProxyConfig:Kc,callStatsAPIReturnStatus:mb,setIdentifiers:Jc,transmissionDirection:qb,endpointType:pb}}"function"==typeof define&&define.amd?define("callstats",[],a):global.callstats=a,module.exports=a}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);